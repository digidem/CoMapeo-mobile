diff --git a/node_modules/@mapeo/core/src/core-manager/compat.js b/node_modules/@mapeo/core/src/core-manager/compat.js
index d4cfdfd..41cc2db 100644
--- a/node_modules/@mapeo/core/src/core-manager/compat.js
+++ b/node_modules/@mapeo/core/src/core-manager/compat.js
@@ -1,17 +1,3 @@
-import { createRequire } from 'module'
-
-const require = createRequire(import.meta.url)
-
-// Export the appropriate version of `quickbit-universal` as the plain import
-// may resolve to an older version in some environments
-const universal = require('quickbit-universal')
-let quickbit = universal
-if (
-  typeof quickbit.findFirst !== 'function' ||
-  typeof quickbit.findLast !== 'function'
-) {
-  // This should always load the fallback from the locally installed version
-  quickbit = require('quickbit-universal/fallback')
-}
+import quickbit from 'quickbit-universal'
 
 export { quickbit }
diff --git a/node_modules/@mapeo/core/src/discovery/dns-sd.js b/node_modules/@mapeo/core/src/discovery/dns-sd.js
index 85d38b0..77ff516 100644
--- a/node_modules/@mapeo/core/src/discovery/dns-sd.js
+++ b/node_modules/@mapeo/core/src/discovery/dns-sd.js
@@ -40,14 +40,21 @@ export class DnsSd extends TypedEmitter {
       this.#log(`Ignoring service up from self`)
       return
     }
-    const address = service.addresses?.find(isIPv4)
-    /* c8 ignore start */
+
+    let address = service.addresses?.find(isIPv4)
+    const { name, port, referer } = service
+
+    if (!address) {
+      if (!referer) {
+        return
+      }
+      address = referer.address
+    }
+
     if (!address) {
-      this.#log(`service up (${service.name}) with no ipv4 addresses`)
       return
     }
-    /* c8 ignore stop */
-    const { name, port } = service
+
     this.#log('serviceUp', name.slice(0, 7), address, port)
     this.emit('up', { port, name, address })
   }
